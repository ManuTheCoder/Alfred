var http=require("http"),url=require("url"),fs=require("fs"),contents=fs.readFileSync("index.html").toString();const express=require("express"),app=express(),port=3e3,fetch=require("node-fetch");app.get("/",(e,a)=>a.send(contents)),app.listen(3e3,()=>{console.log("Alfred listening at http://localhost:3000")});const Discord=require("discord.js"),client=new Discord.Client;var dice1=[1,2,3,4,5,6],cf=["Heads","Tails"];function getArrayRandomElement(e){if(e&&e.length)return e[Math.floor(Math.random()*e.length)]}client.login(process.env.DISCORD_TOKEN);const talkedRecently=new Set;function getRandomInt(e,a){return e=Math.ceil(e),a=Math.floor(a),Math.floor(Math.random()*(a-e+1))+e}function compare(e,a){return e.VALUE<a.VALUE?-1:e.VALUE>a.VALUE?1:0}client.on("guildMemberAdd",e=>{const a=e.guild.channels.cache.find(e=>"member-log"===e.name);a&&a.send(`Welcome to the server, ${e}`)}),client.on("message",e=>{if(console.log(e.content.toLowerCase()),!e.channel.nsfw||""==e.author.id){if(new RegExp(`(\\b|\\d)(${["ass","fuck","bitch","shit","bastard","asshole","dick"].join("|")})(\\b|\\d)`,"i").test(e.content.toLowerCase())){var a=(new Discord.MessageEmbed).setTitle("Deleted!").setColor([252,25,67]).setDescription("No profanity!");e.channel.send(a),e.delete()}}switch(e.content.toLowerCase()){case"-a toggle passive mode":"undefined"!==(h=JSON.parse(fs.readFileSync("./database/passive.json","utf-8")))[e.author.id]?0==h[e.author.id]?(h[e.author.id]=!0,e.reply("Passive mode enabled")):(h[e.author.id]=!1,e.reply("Passive mode disabled")):h[e.author.id]=!1,fs.writeFileSync("./database/passive.json",JSON.stringify(h),"utf-8");break;case"-a hello":e.reply("Hello!");break;case"-a credits":a=(new Discord.MessageEmbed).setTitle("Credits").setColor([235,229,73]).setDescription("Thanks to these people and services for keeping this bot up & running!").addField("People","\n@ManuTheCoder#5821\n@R22 Gamer#8398").addField("Services","\n\tNode.JS\n\tExpressJS\n\tCatAas (For cute cats!!!)\n\tPicsum.photos (For random photos)\n\tRepl.it\n\tGitHub\t\t\t\t\t\n\t");e.channel.send(a);break;case"-a flip coin":case"-a coinflip":a=(new Discord.MessageEmbed).setTitle("<:Alferdocoins:856991023754772521> Coin Flip <:Alferdocoins:856991023754772521>").setColor([235,229,73]).addField("Result: ",getArrayRandomElement(cf));e.channel.send(a);break;case"-a roll dice":case"-a diceroll":var t=dice1[Math.floor(Math.random()*dice1.length)];switch(t){case 1:var s="https://upload.wikimedia.org/wikipedia/commons/1/1b/Dice-1-b.svg";break;case 2:s="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5f/Dice-2-b.svg/1200px-Dice-2-b.svg.png";break;case 3:s="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b1/Dice-3-b.svg/1024px-Dice-3-b.svg.png";break;case 4:s="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fd/Dice-4-b.svg/557px-Dice-4-b.svg.png";break;case 5:s="https://upload.wikimedia.org/wikipedia/commons/thumb/0/08/Dice-5-b.svg/1200px-Dice-5-b.svg.png";break;case 6:s="https://upload.wikimedia.org/wikipedia/commons/thumb/2/26/Dice-6-b.svg/768px-Dice-6-b.svg.png"}e.react("‚úÖ");a=(new Discord.MessageEmbed).setColor([255,255,255]).setTitle("Dice Roll").setThumbnail(s).addField("Result ",t);e.channel.send(a);break;case"-a beg":if(talkedRecently.has(e.author.id)){a=(new Discord.MessageEmbed).setTitle("Slow it down!").setColor([222,38,53]).setDescription("Whoah whoah woah. Easy there buddy! There's no point in spamming this command. You are tired from begging, and you need to wait 5 seconds before working again,  <@!"+e.author+">");e.channel.send(a)}else{if("Tails"==cf[Math.floor(Math.random()*cf.length)]){var o=JSON.parse(fs.readFileSync("./database/money.json","utf-8")),n=getRandomInt(1,10);"null"==o[e.author.id]||"undefined"==o[e.author.id]||null==o[e.author.id]?o[e.author.id]=1:o[e.author.id]=o[e.author.id]+n;a=(new Discord.MessageEmbed).setTitle("Beg").setColor([235,229,73]).addField("Coins Earned: ",n+" coins").addField("Coin Balance: ",o[e.author.id]+" coins");e.channel.send(a),fs.writeFileSync("./database/money.json",JSON.stringify(o),"utf-8"),e.react("ü™ô")}else e.channel.send("No coins earned");talkedRecently.add(e.author.id),setTimeout(()=>{talkedRecently.delete(e.author.id)},5e3)}break;case"-a random image":e.channel.send(`\n\t\t\thttps://picsum.photos/${getRandomInt(100,1e3)}/${getRandomInt(100,1e3)}?nocache=${encodeURI(new Date)}\n\t\t\t`);break;case"-a cat":e.channel.send(`\n\t\t\thttps://cataas.com/cat/says/%20?nocache=${encodeURI(new Date)}\n\t\t\t`);break;case"-a cat gif":e.channel.send(`\n\t\t\thttps://cataas.com/cat/gif?nocache=${encodeURI(new Date)}\n\t\t\t`);break;case"-a cat cute":e.channel.send(`\n\t\t\thttps://cataas.com/cat/cute?nocache=${encodeURI(new Date)}\n\t\t\t`);break;case"-a count":var i=0,r=setInterval(function(){i<10?(i++,e.channel.send(i)):clearTimeout(r)},100);break;case"-a lenny":e.channel.send(getArrayRandomElement(["( Õ°¬∞ Õú ñ Õ°¬∞)","( Õ†¬∞ Õü ñ Õ°¬∞)","( Õ°~ Õú ñ Õ°¬∞)","( Õ° ò Õú ñ Õ° ò)","( Õ°o Õú ñ Õ°o)","(¬∞ Õú ñ ¬∞)","( ‚Äæ ñÃ´‚Äæ)","( ‡≤† Õú ñ‡≤†)","( Õ°¬∞  ñÃØ Õ°¬∞)","( Õ°‡≤• Õú ñ Õ°‡≤•)","‡ºº  Õ°¬∞ Õú ñ Õ°¬∞ ‡ºΩ","(‚ñÄÃøƒπÃØ‚ñÄÃø Ãø)","( ‚úß‚âñ Õú ñ‚âñ)","(‡∏á Õ†¬∞ ÕüŸÑÕú Õ°¬∞)‡∏á","(Õ° Õ°¬∞ Õú „Å§ Õ°Õ°¬∞) ","[Ã≤ÃÖ$Ã≤ÃÖ(Ã≤ÃÖ Õ°¬∞ Õú ñ Õ°¬∞Ã≤ÃÖ)Ã≤ÃÖ$Ã≤ÃÖ]","(‚úø‚ù¶ Õú ñ ‚ù¶)","·ï¶( Õ°¬∞ Õú ñ Õ°¬∞)·ï§","¬Ø_( Õ°¬∞ Õú ñ Õ°¬∞)_/¬Ø","(‚ïØ Õ†¬∞ Õü ñ Õ°¬∞)‚ïØ‚îª‚îÅ‚îª","( Õ°¬∞( Õ°¬∞ Õú ñ( Õ°¬∞ Õú ñ Õ°¬∞) ñ Õ°¬∞) Õ°¬∞)","¬Ø_(„ÉÑ)_/¬Ø","‡≤†_‡≤†"]));break;case"-a shop":a=(new Discord.MessageEmbed).setTitle("Shop").setColor([235,229,73]).setDescription("\n$300 `-a buy padlock` - Prevent people from stealing your money!\n\t\t\t\t\t");e.channel.send(a);break;case"-a pet list":a=(new Discord.MessageEmbed).setTitle("Pets").setThumbnail("http://dogprintsgrooming.com/wp-content/uploads/2015/03/Dog_Print_Icons_3.png").setFooter("Tip: Enter -a buy [PET NAME] to buy a pet\n Example: -a buy dog").setColor([getRandomInt(0,255),getRandomInt(0,255),getRandomInt(0,255)]).addField("Pets","\n**Dog** -   300 <:Alferdocoins:856991023754772521>\n**Cat** -   300 <:Alferdocoins:856991023754772521>\n**Parrot** -   350 <:Alferdocoins:856991023754772521>\n**Rock** -  300 <:Alferdocoins:856991023754772521>\n**Frog** -  400 <:Alferdocoins:856991023754772521>\n**Lizard** -  400 <:Alferdocoins:856991023754772521>\n**Owl** -  500 <:Alferdocoins:856991023754772521>\n**Snake** -   550 <:Alferdocoins:856991023754772521>\n**Tropical Parakeet** -   600 <:Alferdocoins:856991023754772521>\n**Cougar** -  600 <:Alferdocoins:856991023754772521>\n**Tiger** -  800 <:Alferdocoins:856991023754772521>\n").addField("Legendary Pets","\nDragon -   5000 <:Alferdocoins:856991023754772521>\nArctic Wolf -  4500 <:Alferdocoins:856991023754772521>\nEagle -  2000 <:Alferdocoins:856991023754772521>");e.channel.send(a);break;case"-a help":case"-a commands":case"<@!844303394335096862>":case"-a cmds":;!function(){const a=(new Discord.MessageEmbed).setTitle("Commands").setColor([getRandomInt(0,255),getRandomInt(0,255),getRandomInt(0,255)]).setFooter("More features Coming Soon!").setThumbnail("https://icons-for-free.com/iconfiles/png/512/circle+command+key+keyboard+modifier+icon-1320196704338840666.png").addField("Remember","\n*All Commands begin with an `-a`*").addField("Cats","\n:cat:‚†Ä **-a cat** - Show me a cat image\n:cat:‚†Ä **-a cat cute** - Show me a cat image (CUTE)\n:cat:‚†Ä **-a cat gif** - Show me a cat image (GIF)\n").addField("Random","\n:person_pouting: **-a profile** - View profile\n:robot: ‚†Ä**-a roll dice** - Roll a dice\n:robot: ‚†Ä**-a rpc [rock, paper, scissors]** - Rock Paper Scissors (Choose one)\n<:Alferdocoins:856991023754772521> ‚†Ä**-a flip coin OR -a coinflip**- Flip a coin\n").addField("Other Commands","\n:question:‚†Ä **-a help OR -a cmds OR -a commands** - Ask me for help\n:laughing:‚†Ä **-a meme** - Show me a meme!\n:wave:‚†Ä **-a hello** - Say Hello to me\n:frame_photo:‚†Ä **-a random image** - Show random image\n:slight_smile: **-a help** - Show an embed \n:robot: ‚†Ä**-a credits**  - Credits for this bot\n**-a r :slight_smile: ** - (For example), react to the last message in current channel\n").addField("Money","\n:moneybag: **-a steal @user** - Steal from a user\n:briefcase: **-a work** - Work\n:money_with_mouth: **-a leaderboard** - View top 10 richest people in server\n:money_with_wings: **-a beg** - Beg for coins\n:bank: **-a balance** - View Balance\n:innocent: **-a toggle passive mode** Turn on passive mode\n").addField("Shop & Pets","\nUse `-a shop` for list of items\nUse `-a pet list` for list of pets\nUse `-a buy [PET NAME]` to buy a pet\nUse `-a my pets` to view pets owned\n");e.channel.send(a)}();break;case"-a meme":fetch("https://meme-api.herokuapp.com/gimme",{method:"Get"}).then(e=>e.json()).then(a=>{var t=(new Discord.MessageEmbed).setTitle(a.title).setColor([getRandomInt(0,255),getRandomInt(0,255),getRandomInt(0,255)]).setURL(a.postLink).setImage(a.url).setFooter("üëç "+a.ups+" | "+a.author);e.channel.send(t)});break;case"-a work":if(console.log(talkedRecently),talkedRecently.has(e.author.id)){a=(new Discord.MessageEmbed).setTitle("Slow it down!").setColor([222,38,53]).setDescription("Whoah whoah woah. Easy there buddy! There's no point in spamming this command. You are tired from working, and you need to wait 5 seconds before working again,  <@!"+e.author+">");e.channel.send(a)}else{o=JSON.parse(fs.readFileSync("./database/money.json","utf-8"));var d=getRandomInt(5,20);"null"==o[e.author.id]||"undefined"==o[e.author.id]||null==o[e.author.id]?o[e.author.id]=0:o[e.author.id]=o[e.author.id]+d;a=(new Discord.MessageEmbed).setTitle("Work").setColor([getRandomInt(0,255),getRandomInt(0,255),getRandomInt(0,255)]).addField("Coins Earned",d+" <:Alferdocoins:856991023754772521>").addField("Coin Balance: ",o[e.author.id]+" coins");e.channel.send(a),fs.writeFileSync("./database/money.json",JSON.stringify(o),"utf-8"),e.react("üíº"),talkedRecently.add(e.author.id),setTimeout(()=>{talkedRecently.delete(e.author.id)},5e3)}break;case"-a my pets":if((C=JSON.parse(fs.readFileSync("./database/pets.json","utf-8")))[e.author.id]){C=C[e.author.id];var c="";for(const[e,a]of Object.entries(C))c+=`**${a}** ${e}s\n`;a=(new Discord.MessageEmbed).setTitle("Pets").setColor([235,229,73]).setDescription(c);e.channel.send(a)}else{a=(new Discord.MessageEmbed).setTitle("Pets").setColor([235,229,73]).setDescription("No pets owned. Use `-a pet list` to see the list of pets and `-a buy [pet]` to buy a pet.");e.channel.send(a)}break;case"-a leaderboard":case"-a top":case"-a richest":var l=[],h=JSON.parse(fs.readFileSync("./database/money.json","utf-8"));client.guilds.cache.get(e.guild.id).members.cache.map(e=>e.id).forEach(e=>{for(const[a,t]of Object.entries(h))e==a&&l.push({KEY:a,VALUE:t})});var p=l=l.sort(compare).reverse();l="",p.slice(0,10).forEach(e=>{var a=client.users.cache.get(e.KEY).username;l+=` **${a.trim()}** - ${e.VALUE}  <:Alferdocoins:856991023754772521>\n\t\t\t\t`});a=(new Discord.MessageEmbed).setTitle("Top 10 richest people in this server").setColor([235,229,73]).setDescription(l);e.channel.send(a);break;case"-a balance":"null"==(o=JSON.parse(fs.readFileSync("./database/money.json","utf-8")))[e.author.id]||"undefined"==o[e.author.id]||null==o[e.author.id]?o[e.author.id]=0:o[e.author.id];a=(new Discord.MessageEmbed).setTitle("Balance").setColor([235,229,73]).addField("Coin Balance: ",o[e.author.id]+" coins");e.channel.send(a),fs.writeFileSync("./database/money.json",JSON.stringify(o),"utf-8");break;case"-a buy padlock":if((o=JSON.parse(fs.readFileSync("./database/money.json","utf-8")))[e.author.id]&&o[e.author.id]-300>=0){o[e.author.id]=o[e.author.id]-300;var u=JSON.parse(fs.readFileSync("./database/padlocks.json","utf-8"));null==u[e.author.id]?u[e.author.id]=1:u[e.author.id]++,fs.writeFileSync("./database/padlocks.json",JSON.stringify(u),"utf-8")}else e.channel.send("Not enough Money!");fs.writeFileSync("./database/money.json",JSON.stringify(o),"utf-8"),e.channel.send("**Purchase complete**\nPadlocks are applied automatically!");break;default:if(e.content.startsWith("-a rpc")){var m=e.content.replace("-a rpc ","");if("rock"==m.toLowerCase()||"scissors"==m.toLowerCase()||"paper"==m.toLowerCase()){var f=getArrayRandomElement(["rock","paper","scissors"]),g=!1;if(f==m){var b=[201,185,56];g="Tie  :neutral_face:"}else if("paper"==m&&"scissors"==f||"rock"==m&&"paper"==f||"scissors"==m&&"rock"==f){b=[201,81,56];g="You Lost  :slight_frown:"}else{b=[62,150,62];g="You won!\t:partying_face:"}switch(m){case"rock":s="https://images.vexels.com/media/users/3/145827/isolated/preview/357f06ecbaaa77d750259c459c0ed55f-round-rock-illustration-by-vexels.png";break;case"paper":s="https://img.freepik.com/free-vector/white-paper-sheet-illustration_275806-797.jpg?size=338&ext=jpg";break;case"scissors":s="https://upload.wikimedia.org/wikipedia/commons/thumb/7/74/Scissors_icon_black.svg/1024px-Scissors_icon_black.svg.png"}a=(new Discord.MessageEmbed).addField("Your input: ",m).setColor(b).setTitle(g).setThumbnail(s).addField("Computer's input: ",f);e.channel.send(a)}}else if(e.content.startsWith("-a buy"))if("-a buy"!==e.content){var y,w=e.content.replace("-a buy ","");h=JSON.parse(fs.readFileSync("./database/money.json","utf-8"));switch(w){case"dog":y=300;break;case"lizard":y=500;break;case"cat":y=300;break;case"parrot":y=350;break;case"rock":y=300;break;case"frog":y=400;break;case"owl":y=500;break;case"snake":y=550;break;case"tropical parakeet":case"cougar":y=600;break;case"tiger":y=800;break;case"dragon":y=5e3;break;case"arctic wolf":y=4500;break;case"eagle":y=2e3}if(h[e.author.id]>=y){if(h[e.author.id]=h[e.author.id]-y,(C=JSON.parse(fs.readFileSync("./database/pets.json","utf-8")))[e.author.id])(D=C[e.author.id])[w]?D[w]++:D[w]=1;else C[e.author.id]={},(D=C[e.author.id])[w]?D[w]++:D[w]=1;fs.writeFileSync("./database/pets.json",JSON.stringify(C),"utf-8"),fs.writeFileSync("./database/money.json",JSON.stringify(h),"utf-8"),e.reply("Bought pet successfully!")}else e.reply("You don't have enough money!")}else e.reply("Invalid pet name");else if(e.content.startsWith("-a steal")){if(D=(D=e.content.replace("-a steal ","")).replace("<@!","").replace(">",""),0==(E=client.users.cache.get(D)).bot){o=JSON.parse(fs.readFileSync("./database/money.json","utf-8"));var k=JSON.parse(fs.readFileSync("./database/padlocks.json","utf-8")),S=JSON.parse(fs.readFileSync("./database/passive.json","utf-8"));if(1==S[e.author.id]){a=(new Discord.MessageEmbed).setColor([235,64,52]).setTitle("Steal").setDescription("You're currently on passive mode!");return e.channel.send(a),!1}if(console.log(S[D]),1==S[D]){a=(new Discord.MessageEmbed).setColor([235,64,52]).setTitle("Steal").setDescription("Hey, leave that passive peace-loving hippy alone!");return e.channel.send(a),!1}if(!k[D]>0){k[D]-1>=0?k[D]--:k[D]=0,fs.writeFileSync("./database/padlocks.json",JSON.stringify(k),"utf-8");var v=getRandomInt(0,100);if(0!==o[D]&&"undefined"!==o[D]&&"null"!==o[D]&&o[D]-v>=0){o[D]=o[D]-v,o[e.author.id]=o[e.author.id]+v,fs.writeFileSync("./database/money.json",JSON.stringify(o),"utf-8");a=(new Discord.MessageEmbed).setColor([235,64,52]).setTitle("Steal").setDescription("You stole: "+v+" <:Alferdocoins:856991023754772521>");e.channel.send(a)}else{a=(new Discord.MessageEmbed).setColor([235,64,52]).setTitle("Steal").setDescription("User doesn't have enough money to steal!");e.channel.send(a)}}else{k[D]-1>=0&&k[D]--;var F=JSON.parse(fs.readFileSync("./database/money.json","utf-8"));F[e.author.id]&&(F[e.author.id]=F[e.author.id]-500),fs.writeFileSync("./database/money.json",JSON.stringify(F),"utf-8"),fs.writeFileSync("./database/padlocks.json",JSON.stringify(k),"utf-8"),e.channel.send("User has padlock attached to wallet! You got caught lost <:Alferdocoins:856991023754772521> 500")}}else e.channel.send("Hey, go pick on someone your own size! You can't steal from bots....")}else if(e.content.startsWith("-a profile")){l=[],h=JSON.parse(fs.readFileSync("./database/money.json","utf-8"));if(client.guilds.cache.get(e.guild.id).members.cache.map(e=>e.id).forEach(e=>{for(const[a,t]of Object.entries(h))e==a&&l.push({KEY:a,VALUE:t})}),l=l.sort(compare).reverse(),"-a profile"==e.content)var D={id:e.author.id,name:e.author.tag,pic:e.author.avatar,bot:e.author.bot,full:e.author};else{var E=client.users.cache.get(e.content.replace(/\D/g,""));D={id:e.content.replace(/\D/g,""),name:E.tag,pic:E.avatar,full:E,bot:E.bot}}if(0==D.bot){var C;if((C=JSON.parse(fs.readFileSync("./database/pets.json","utf-8")))[e.author.id]){c="";if("undefined"!==(C=C[D.id])&&void 0!==C)for(const[e,a]of Object.entries(C))c+=`**${a}** ${e}s\n`;else c="No pets owned"}else c="No pets owned.";console.log(D.full);var R=!1;for(i=0;i<l.length;i++)if(l[i].KEY==D.id){R=!0;break}o=JSON.parse(fs.readFileSync("./database/money.json","utf-8")),a=(new Discord.MessageEmbed).setTitle(D.name).setDescription(1==R?" :moneybag: Top 10 richest people in server!":"").setThumbnail("https://cdn.discordapp.com/avatars/"+D.id+"/"+D.pic+".png?size=256").addField("Balance",(o[D.id]?o[D.id]:"0")+" <:Alferdocoins:856991023754772521>").addField("Pets",c).addField("XP","Coming Soon!");e.channel.send(a)}else e.reply("User is bot!")}else if(e.content.startsWith("-a slots"))if("-a slots"==e.content){a=(new Discord.MessageEmbed).setTitle("<:Alferdocoins:856991023754772521> Slots <:Alferdocoins:856991023754772521>").setColor([235,229,73]).setDescription("Incorrect value for slots. Please specify money to earn/lose. Example: -a slots 10");e.channel.send(a)}else{var T=parseInt(e.content.replace("-a slots ",""));r=getArrayRandomElement(cf),h=JSON.parse(fs.readFileSync("./database/money.json","utf-8"));console.log(h[e.author.id]-T),h[e.author.id]&&parseInt(h[e.author.id])-parseInt(T)>=0?"Heads"==r?(h[e.author.id]=h[e.author.id]+T,e.reply("You won <:Alferdocoins:856991023754772521>‚†Ä"+T+"!"),fs.writeFileSync("./database/money.json",JSON.stringify(h),"utf-8")):(h[e.author.id]=h[e.author.id]-T,e.reply("You lost <:Alferdocoins:856991023754772521>‚†Ä"+T+"!"),fs.writeFileSync("./database/money.json",JSON.stringify(h),"utf-8")):e.reply("Not enough coins!")}else if(e.content.startsWith("-a r")){console.log(e.channel.lastMessage);var A=e.content.replace("-a r ","");e.channel.lastMessage.react(A),e.channel.messages.fetch({limit:2}).then(e=>{e.last().react(A)}),e.delete()}}}),client.on("ready",()=>{console.log(`Logged in as ${client.user.tag}!`)});